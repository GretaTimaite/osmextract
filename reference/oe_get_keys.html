<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Return keys and (optionally) values stored in "other_tags" column — oe_get_keys • osmextract</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Return keys and (optionally) values stored in "other_tags" column — oe_get_keys" />
<meta property="og:description" content="This function returns the OSM keys and (optionally) the values stored in the
other_tags field. See Details. In both cases, the keys are sorted according
to the number of occurrences, which means that the most common keys are
stored first." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">osmextract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/osmextract.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/providers.html">Add new OpenStreetMap providers</a>
    </li>
    <li>
      <a href="../articles/providers_comparisons.html">Comparing the supported OSM providers</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ropensci/osmextract/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Return keys and (optionally) values stored in "other_tags" column</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/osmextract/blob/master/R/get-key-values.R'><code>R/get-key-values.R</code></a></small>
    <div class="hidden name"><code>oe_get_keys.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function returns the OSM keys and (optionally) the values stored in the
<code>other_tags</code> field. See Details. In both cases, the keys are sorted according
to the number of occurrences, which means that the most common keys are
stored first.</p>
    </div>

    <pre class="usage"><span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='va'>zone</span>, layer <span class='op'>=</span> <span class='st'>"lines"</span>, values <span class='op'>=</span> <span class='cn'>FALSE</span>, which_keys <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='va'>zone</span>, layer <span class='op'>=</span> <span class='st'>"lines"</span>, values <span class='op'>=</span> <span class='cn'>FALSE</span>, which_keys <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># S3 method for character</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='va'>zone</span>, layer <span class='op'>=</span> <span class='st'>"lines"</span>, values <span class='op'>=</span> <span class='cn'>FALSE</span>, which_keys <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># S3 method for sf</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='va'>zone</span>, layer <span class='op'>=</span> <span class='st'>"lines"</span>, values <span class='op'>=</span> <span class='cn'>FALSE</span>, which_keys <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='co'># S3 method for oe_key_values_list</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"oe_max_print_keys"</span>, <span class='fl'>10L</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>zone</th>
      <td><p>An <code>sf</code> object with an <code>other_tags</code> field or a character vector
(of length 1) that can be linked to or pointing to a <code>.osm.pbf</code> or <code>.gpkg</code>
file with an <code>other_tags</code> field. Character vectors are linked to <code>.osm.pbf</code>
files using <code><a href='oe_find.html'>oe_find()</a></code>.</p></td>
    </tr>
    <tr>
      <th>layer</th>
      <td><p>Which <code>layer</code> should be read in? Typically <code>points</code>, <code>lines</code>
(the default), <code>multilinestrings</code>, <code>multipolygons</code> or <code>other_relations</code>. If
you specify an ad-hoc query using the argument <code>query</code> (see introductory
vignette and examples), then <code><a href='oe_get.html'>oe_get()</a></code> and <code><a href='oe_read.html'>oe_read()</a></code> will read the layer
specified in the query and ignore <code>layer</code>. See also
<a href='https://github.com/ropensci/osmextract/issues/122'>#122</a>.</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>Logical. If <code>TRUE</code>, then function returns the keys and the
corresponding values, otherwise only the keys. Defaults to <code>FALSE. </code></p></td>
    </tr>
    <tr>
      <th>which_keys</th>
      <td><p>Character vector used to subset only some keys and
corresponding values. Ignored if <code>values</code> is <code>FALSE</code>. See examples.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>object of class <code>oe_key_values_list</code></p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Maximum number of keys (and corresponding values) to print; can be
set globally by <code><a href='https://rdrr.io/r/base/options.html'>options(oe_max_print_keys=...)</a></code>. Default value is 10.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If the argument <code>values</code> is <code>FALSE</code> (the default), then the function
returns a character vector with the names of all keys stored in the
<code>other_tags</code> field. If <code>values</code> is <code>TRUE</code>, then the function returns named
list which stores all keys and the corresponding values. In the latter
case, the returned object has class <code>oe_key_values_list</code> and we defined an
ad-hoc printing method. See Details.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>OSM data are typically documented using several
<a href='https://wiki.openstreetmap.org/wiki/Tags'><code>tags</code></a>, i.e. pairs of two
items, namely a <code>key</code> and a <code>value</code>. The conversion between <code>.osm.pbf</code> and
<code>.gpkg</code> formats is governed by a <code>CONFIG</code> file that lists which tags must
be explicitly added to the <code>.gpkg</code> file. All the other keys are
automatically stored using an <code>other_tags</code> field with a syntax compatible
with the PostgreSQL HSTORE type. See
<a href='https://gdal.org/drivers/vector/osm.html#driver-capabilities'>here</a> for
more details.</p>
<p>When the argument <code>values</code> is <code>TRUE</code>, then the function returns a named list
of class <code>oe_key_values_list</code> that, for each key, summarises the
corresponding values. The key-value pairs are stored using the following
format:
<code>list(key1 = c("value1", "value1", "value2", ...), key2 = c("value1", ...) ...)</code>.
We decided to implement an ad-hoc method for printing objects of class
<code>oe_key_values_list</code> using the following structure:</p><pre>
key1 = {#value1 = n1; #value2 = n2; #value3 = n3, ...}
key2 = {#value1 = n1; #value2 = n2; ...}
key3 = {#value1 = n1}
...
</pre><p>where <code>n1</code> denotes the number of times that value1 is repeated, <code>n2</code> denotes
the number of times that value2 is repeated and so on. Also the values are
listed according to the number of occurrences in decreasing order. By
default, the function prints only the ten most common keys, but the number
can be adjusted using the option <code>oe_max_print_keys</code>.</p>
<p>Finally, the <code>hstore_get_value()</code> function can be used inside the <code>query</code>
argument in <code><a href='oe_get.html'>oe_get()</a></code> to extract one particular tag from an existing file.
Check the introductory vignette and see examples.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='oe_vectortranslate.html'>oe_vectortranslate()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Point to an existing OSM extract</span>
<span class='va'>its_path</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"its-example.osm.pbf"</span>, package <span class='op'>=</span> <span class='st'>"osmextract"</span><span class='op'>)</span>

<span class='co'># Get keys</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='st'>"ITS Leeds"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error: The input file does not exist and can't be matched with any existing file. You can download it using oe_get(zone, download_only = TRUE).</span></div><div class='input'>
<span class='co'># Get keys and values</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='st'>"ITS Leeds"</span>, values <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error: The input file does not exist and can't be matched with any existing file. You can download it using oe_get(zone, download_only = TRUE).</span></div><div class='input'>
<span class='co'># Subset some keys</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='st'>"ITS Leeds"</span>, values <span class='op'>=</span> <span class='cn'>TRUE</span>, which_keys <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"surface"</span>, <span class='st'>"lanes"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error: The input file does not exist and can't be matched with any existing file. You can download it using oe_get(zone, download_only = TRUE).</span></div><div class='input'>
<span class='co'># Print all (non-NA) values for a given set of keys</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='st'>"ITS Leeds"</span>, values <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span><span class='st'>"surface"</span><span class='op'>]</span>
</div><div class='output co'>#&gt; <span class='error'>Error: The input file does not exist and can't be matched with any existing file. You can download it using oe_get(zone, download_only = TRUE).</span></div><div class='input'>
<span class='co'># Get keys from an existing sf object</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>its</span> <span class='op'>=</span> <span class='fu'><a href='oe_get.html'>oe_get</a></span><span class='op'>(</span><span class='st'>"ITS Leeds"</span><span class='op'>)</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='va'>its</span>, values <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>}</span>

<span class='co'># Get keys from a character vector pointing to a file (might be faster than</span>
<span class='co'># reading the complete file)</span>
<span class='fu'>oe_get_keys</span><span class='op'>(</span><span class='va'>its_path</span>, values <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Found 38 unique keys, printed in ascending order of % NA values. The first 10 keys are: 
#&gt; surface (91% NAs) = {#asphalt = 12; #paved = 3; #cobblestone = 1; #paving_sto...}
#&gt; lanes (92% NAs) = {#2 = 9; #1 = 7}
#&gt; bicycle (92% NAs) = {#yes = 10; #designated = 5}
#&gt; lit (92% NAs) = {#yes = 15}
#&gt; access (93% NAs) = {#permissive = 12; #yes = 2}
#&gt; oneway (93% NAs) = {#yes = 13}
#&gt; maxspeed (94% NAs) = {#30 mph = 12}
#&gt; ref (95% NAs) = {#A660 = 9; #4184 = 1}
#&gt; foot (95% NAs) = {#yes = 5; #designated = 4}
#&gt; natural (96% NAs) = {#tree_row = 7}
#&gt; [Truncated output...]</div><div class='input'>
<span class='co'># Add a key to an existing .gpkg file without repeating the</span>
<span class='co'># vectortranslate operations</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>its</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='fu'><a href='oe_read.html'>oe_read</a></span><span class='op'>(</span>
  <span class='va'>its_path</span>,
  query <span class='op'>=</span> <span class='st'>"SELECT *, hstore_get_value(other_tags, 'oneway') AS oneway FROM lines"</span>,
  quiet <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span><span class='op'>)</span><span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrea Gilardi, Robin Lovelace.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


